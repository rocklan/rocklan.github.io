---
date: 2006-05-04
category: technical
readtime: true
---
<h2>Ajax in VB.NET without Visual Studio!</h2>
<p>A couple of weeks back I wanted to try doing a bit of Ajax. ASP.NET (using VB) is my language of choice, which I thought would be widely supported. Not quite. Microsoft have a new Ajax library, which I haven't  checked out yet, so I decided to try out Jason Diamon's Ajax.NET. Once I'd got it to work it was brilliant. Here's what I did!</p><h3>Setting up Ajax.NET</h3>
<p>Download Ajax.NET from <a href="http://jason.diamond.name/weblog/2005/10/29/my-ajax-dot-net-release-12">Jason Diamon's</a> site. Unzip it until a dir, let's say c:\temp.</p><p>You'll then need to compile it. Try going into your directory:</p><pre>C:\WINDOWS\Microsoft.NET\Framework\</pre><p>and do a dir. On my machine I have the following directories:</p><pre><br />	05/12/2005  12:56 PM    &lt;DIR&gt;          v1.0.3705<br />	06/03/2006  11:04 PM    &lt;DIR&gt;          v1.1.4322<br />	05/12/2005  12:00 PM    &lt;DIR&gt;          v2.0.50727<br /></pre><p>which means that I have version 1.0, 1.1 and 2.0 of the framework. For this article I'll be using 1.1, just because that's what I'm most comfortable with.</p><p>So what I did was add that directory to my path:</p><pre><br />	set PATH=%path%;C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322<br /></pre><p>You should now be able to type:</p><pre><br />	cd \temp<br />	csc<br /></pre><p>Which is the C#.NET compiler, and you'll get an output like:</p><pre><br />	C:\TEMP>csc<br />	Microsoft (R) Visual C# .NET Compiler version 7.10.3052.4<br />	for Microsoft (R) .NET Framework version 1.1.4322<br />	Copyright (C) Microsoft Corporation 2001-2002. All rights reserved.<br /><br />	fatal error CS2008: No inputs specified<br /></pre><p>Is that really a "fatal" error? Geez talk about overstatement. Anyway.<br />So what you need to do is to compile the .cs files into a DLL:</p><pre><br />	C:\TEMP>cd ajax\ajax<br />	<br />	C:\TEMP\Ajax\Ajax>csc /target:library /out:Ajax.dll *.cs<br />	Microsoft (R) Visual C# .NET Compiler version 7.10.3052.4<br />	for Microsoft (R) .NET Framework version 1.1.4322<br />	Copyright (C) Microsoft Corporation 2001-2002. All rights reserved.<br /><br />	<br />	C:\TEMP\Ajax\Ajax><br /></pre><p>Thanks for the verbose output Microsoft. Was it really that difficult to add a "printf ("Ajax.dll compiled ok");" ? Anyway, you'll notice that you now have a file named Ajax.dll. What we want to do is copy this file into our web applications /bin folder. If you don't have one (and I didn't), just create it:</p><pre><br />	C:\TEMP\Ajax\Ajax>mkdir c:\inetpub\wwwroot\webapp\bin<br />	<br />	C:\TEMP\Ajax\Ajax>copy Ajax.dll c:\inetpub\wwwroot\webapp\bin<br /></pre><h3>Creating the Web application!</h3>
<p>Setup a test page that has the following HTML:</p><pre><br />	&lt;%@ Page Language="VB" Debug="true" %&gt;<br />	&lt;%@ Register TagPrefix="ajax" Namespace="Ajax" Assembly="Ajax" %&gt;<br />	<font color="blue"><br />	&lt;script runat="server"&gt;<br />		sub Page_Load()<br />			Ajax.Manager.Register(me)<br />		end sub<br />		&lt;Ajax.Method&gt; function getDetails(staffID as string) <br />			dim strStaffName as string = "not found!"<br />			select staffID<br />				case "1": strStaffName = "Neo Anderson"<br />				case "2": strStaffName = "Sean Michaud"<br />				case "3": strStaffName = "Some other idiot name"<br />			end select<br />			getDetails = "Corresponds to: " + strStaffName<br />		end function<br />	&lt;/script&gt;<br />	</font><br />	<font color="green"><br />	&lt;script language="javascript"&gt;<br />		function go()<br />		{<br />			var result = ASP.test_aspx.getDetails(document.getElementById('inputID').value);<br />			if (result.error) {<br />				document.getElementById('somedata').innerHTML = "error fetching data";<br />			} else {<br />				document.getElementById('somedata').innerHTML = result.value;<br />			}<br />		}<br />	&lt;/script&gt;<br />	</font><br />	&lt;html&gt;<br />	&lt;head&gt;<br />		&lt;title&gt;Test Ajax code&lt;/title&gt;<br />	&lt;/head&gt;<br />	&lt;body&gt;<br />		&lt;form runat="Server"&gt;<br />		Please enter an ID from 1-3:<br />			<font color="blue">&lt;asp:textbox id="inputID" runat="server" maxlength="8" onKeyUp="go()"/&gt; &lt;br /&gt;<br />			&lt;div id="somedata"&gt;&lt;/div&gt;</font><br />		&lt;/form&gt;<br />	&lt;/body&gt;<br />	&lt;/html&gt;<br /></pre><p>That'll do for an example. So what's going on here?</p><p>Well, the first blue block of code involves doing an initialization<br />call to the library. The "getDetails()" function is a typical bit of code that would normally connect up to a database. Now the cool<br />thing with ajax.net is that all you have to do is put in the annotation of :</p><pre><br />        <Ajax.Method><br /></pre><p>And the clever library generates a Javascript wrapper so that you can call your code from the client side! Genius!</p><p>The green javascript code does nothing special. Upon changing the textbox, it sends off a call to our getDetails() function, and displays the result below. Brilliant. There's a huge number of applications for this sort of thing, but my favourite is definitely for data lookup. Typing in someone's name could bring up a list of similar names, or even duplicate names. Have fun!</p><p>